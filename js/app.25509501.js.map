{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/Game.vue?e53b","webpack:///./src/App.vue?8827","webpack:///./src/App.vue","webpack:///./src/components/Game.vue","webpack:///./src/game.worker.js","webpack:///./src/lib/engine.js","webpack:///./src/lib/screen.js","webpack:///./src/lib/loop.js","webpack:///./src/lib/build-tools.js","webpack:///./src/utils/string.js","webpack:///./src/maps/tests.js","webpack:///./src/maps/main.js","webpack:///./src/components/Game.vue?a8de","webpack:///./src/App.vue?97f5","webpack:///./src/main.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","id","class","ref","level","levels","v","k","config","dat","state","isWinner","currentLevel","nextLevel","href","description","debug","type","showVectors","showGhosts","showCollisions","Worker_fn","Worker","__webpack_public_path__","PROP_STATIC","PROP_COLLIDABLE","PROP_KILLER","PROP_WIN_ZONE","PROP_DRAWABLE","BASE_CONFIG","loadLevels","entries","initializeLevel","map","freeze","assign","noop","throttle","burn","burnFunc","_data","obj","now","Date","burndownKey","timerKey","dy","clearTimeout","burnRemaining","this","up","cameraX","camera","find","el","x","prepareCanvas","canvas","ctx","getContext","width","w","height","h","style","scale","flush","buffer","clearRect","drawImage","_drawRect","y","fillStyle","color","inCollision","fillRect","drawVectors","drawables","filter","properties","includes","forEach","strokeStyle","beginPath","cx","cy","vx","dx","vy","moveTo","lineTo","stroke","drawGhosts","x0","y0","drawRects","drawGameOver","textAlign","font","fillText","drawGameWon","draw","isAlive","Event","callbacks","Reactor","events","Loop","fn","registerEvent","running","last","_frame","_tick","tick","addEventListener","registerCallback","callback","eventName","event","dispatchEvent","eventArgs","start","requestAnimationFrame","stop","cancelAnimationFrame","time","dt","CAMERA","SHAPE","BASE_OBSTACLE","BASE_WALL","BASE_PLATFORM","BASE_WIN_ZONE","BASE_HERO","clouds","count","xMin","xMax","yMin","yMax","Math","random","strip","str","replace","level1","level2","ladder","fallTest","verticalPlatform","jumpObstacles","jump","impossiblePlatform","impossibleTrampoline","thinGapMapItems","concat","Number","thinGap","chunkPadsMapItems","chunkPads","chunkBedHop","chunkTreeTrunk","stairs","stepWidth","stepHeight","obstacleH","gap","platformX","overhang","chunkStairCase","chunkTightLeap","chunkFlamingDeath","chunkShortDrop","chunkWallGap","worker","engine","mapWorker","ret","args","postMessage","setup","loadGame","requestFrame","_draw","response","canvasBuffer","reset","handleFrame","e","params","URLSearchParams","location","search","has","cloneNode","handlePress","handleRelease","preventDefault","stopPropagation","document","terminate","immediate","render","__scopeId","components","Game","App","mount"],"mappings":"aACE,SAASA,EAAqBC,GAQ7B,IAPA,IAMIC,EAAUC,EANVC,EAAWH,EAAK,GAChBI,EAAcJ,EAAK,GACnBK,EAAiBL,EAAK,GAIHM,EAAI,EAAGC,EAAW,GACpCD,EAAIH,EAASK,OAAQF,IACzBJ,EAAUC,EAASG,GAChBG,OAAOC,UAAUC,eAAeC,KAAKC,EAAiBX,IAAYW,EAAgBX,IACpFK,EAASO,KAAKD,EAAgBX,GAAS,IAExCW,EAAgBX,GAAW,EAE5B,IAAID,KAAYG,EACZK,OAAOC,UAAUC,eAAeC,KAAKR,EAAaH,KACpDc,EAAQd,GAAYG,EAAYH,IAG/Be,GAAqBA,EAAoBhB,GAE5C,MAAMO,EAASC,OACdD,EAASU,OAATV,GAOD,OAHAW,EAAgBJ,KAAKK,MAAMD,EAAiBb,GAAkB,IAGvDe,IAER,SAASA,IAER,IADA,IAAIC,EACIf,EAAI,EAAGA,EAAIY,EAAgBV,OAAQF,IAAK,CAG/C,IAFA,IAAIgB,EAAiBJ,EAAgBZ,GACjCiB,GAAY,EACRC,EAAI,EAAGA,EAAIF,EAAed,OAAQgB,IAAK,CAC9C,IAAIC,EAAQH,EAAeE,GACG,IAA3BX,EAAgBY,KAAcF,GAAY,GAE3CA,IACFL,EAAgBQ,OAAOpB,IAAK,GAC5Be,EAASM,EAAoBA,EAAoBC,EAAIN,EAAe,KAItE,OAAOD,EAIR,IAAIQ,EAAmB,GAKnBhB,EAAkB,CACrB,IAAO,GAGJK,EAAkB,GAGtB,SAASS,EAAoB1B,GAG5B,GAAG4B,EAAiB5B,GACnB,OAAO4B,EAAiB5B,GAAU6B,QAGnC,IAAIC,EAASF,EAAiB5B,GAAY,CACzCK,EAAGL,EACH+B,GAAG,EACHF,QAAS,IAUV,OANAf,EAAQd,GAAUW,KAAKmB,EAAOD,QAASC,EAAQA,EAAOD,QAASH,GAG/DI,EAAOC,GAAI,EAGJD,EAAOD,QAKfH,EAAoBM,EAAIlB,EAGxBY,EAAoBO,EAAIL,EAGxBF,EAAoBQ,EAAI,SAASL,EAASM,EAAMC,GAC3CV,EAAoBW,EAAER,EAASM,IAClC3B,OAAO8B,eAAeT,EAASM,EAAM,CAAEI,YAAY,EAAMC,IAAKJ,KAKhEV,EAAoBe,EAAI,SAASZ,GACX,qBAAXa,QAA0BA,OAAOC,aAC1CnC,OAAO8B,eAAeT,EAASa,OAAOC,YAAa,CAAEC,MAAO,WAE7DpC,OAAO8B,eAAeT,EAAS,aAAc,CAAEe,OAAO,KAQvDlB,EAAoBmB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQlB,EAAoBkB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,kBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKxC,OAAOyC,OAAO,MAGvB,GAFAvB,EAAoBe,EAAEO,GACtBxC,OAAO8B,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOlB,EAAoBQ,EAAEc,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRtB,EAAoB0B,EAAI,SAAStB,GAChC,IAAIM,EAASN,GAAUA,EAAOiB,WAC7B,WAAwB,OAAOjB,EAAO,YACtC,WAA8B,OAAOA,GAEtC,OADAJ,EAAoBQ,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRV,EAAoBW,EAAI,SAASgB,EAAQC,GAAY,OAAO9C,OAAOC,UAAUC,eAAeC,KAAK0C,EAAQC,IAGzG5B,EAAoB6B,EAAI,IAExB,IAAIC,EAAaC,OAAO,gBAAkBA,OAAO,iBAAmB,GAChEC,EAAmBF,EAAW3C,KAAKsC,KAAKK,GAC5CA,EAAW3C,KAAOf,EAClB0D,EAAaA,EAAWG,QACxB,IAAI,IAAItD,EAAI,EAAGA,EAAImD,EAAWjD,OAAQF,IAAKP,EAAqB0D,EAAWnD,IAC3E,IAAIU,EAAsB2C,EAI1BzC,EAAgBJ,KAAK,CAAC,EAAE,kBAEjBM,K,6ECvJT,W,oFCAA,W,04BCCOyC,GAAG,O,6EAAR,eAEM,MAFN,EAEM,CADJ,eAAa,K,+GCDVC,MAAM,Q,GAQDC,IAAI,U,2BAGX,U,iBACqD,U,2BAMG,kB,EAGvD,eAAM,mB,iBAEgD,iB,EAGtD,eAAM,mB,iBAEoD,qB,wEA5B9D,eAgCM,MAhCN,EAgCM,CA/BJ,eAMM,Y,eALJ,eAIS,UAJDD,MAAM,e,qDAAwB,EAAAE,MAAK,K,qBACzC,eAES,2BAF2B,EAAAC,QAAM,SAAfC,EAAGC,G,wBAA9B,eAES,UAFAtB,MAAOsB,EAA6BhB,IAAKgB,G,eAC7CD,EAAEE,OAAOhC,MAAQ+B,GAAC,gB,qBAFa,EAAAH,WAMxC,eAA8B,SAA9B,EAA8B,UAEtB,EAAAK,IAAIC,OAAS,EAAAD,IAAIC,MAAMC,UAAY,EAAAC,aAAaJ,OAAOK,W,iBAD/D,eAIM,S,EADJ,eAAoD,KAAjDC,KAAK,GAAI,QAAK,8CAAU,EAAAD,WAAA,EAAAA,UAAA,qBAAS,eAAE,c,uBAExC,eAAuD,uBAAxC,EAAAD,aAAaJ,OAAOO,aAAW,IAE9B,EAAAC,O,iBAAhB,eAeW,gBAdT,eAGQ,c,eAFN,eAAqD,SAA9CC,KAAK,W,qDAAoB,EAAAP,MAAMQ,YAAW,K,mBAAjB,EAAAR,MAAMQ,e,IAGxC,EACA,eAGQ,c,eAFN,eAAoD,SAA7CD,KAAK,W,qDAAoB,EAAAP,MAAMS,WAAU,K,mBAAhB,EAAAT,MAAMS,c,IAGxC,EACA,eAGQ,c,eAFN,eAAwD,SAAjDF,KAAK,W,qDAAoB,EAAAP,MAAMU,eAAc,K,mBAApB,EAAAV,MAAMU,kB,6IC7B/B,SAASC,IACtB,OAAO,IAAIC,OAAOC,IAA0B,qC,gICCvC,IAAMC,EAAc,SACdC,EAAkB,cAClBC,EAAc,SACdC,EAAgB,WAChBC,EAAgB,WAEvBC,EAAc,CAClBrD,KAAM,GACNuC,YAAa,GACbK,gBAAgB,EAChBF,aAAa,EACbC,YAAY,GAGP,SAASW,EAAWzB,GACzB,cAAmBxD,OAAOkF,QAAQ1B,GAAlC,eAA2C,CAAtC,6BAAKE,EAAL,KAAQD,EAAR,KACHD,EAAOE,GAAKyB,EAAgB1B,GAE9B,OAAOD,EAGF,SAAS2B,EAAT,GAA0C,IAAfxB,EAAe,EAAfA,OAAQyB,EAAO,EAAPA,IAClC7B,EAAQ,CACZI,OAAQ3D,OAAOqF,OAAOrF,OAAOsF,OAAO,GAAIN,EAAarB,IACrDyB,OAKF,OAFA7B,EAAMI,OAAS3D,OAAOqF,OAAO9B,EAAMI,QAE5BJ,EAYT,SAASgC,KAST,SAASC,EAAS7D,GAAoC,IAA9B8D,EAA8B,uDAAvB,IAAMC,EAAiB,uDAANH,EACxCI,EAAQ,GAEd,OAAO,SAAeC,EAAKrG,GACzB,IAAMsG,EAAMC,KAAKD,MACXE,EAAc,WACdC,EAAW,QAEF,IAAXJ,EAAIK,KACNC,aAAaP,EAAMK,WACZL,EAAMI,IAGW,MAAtBJ,EAAMI,KACRJ,EAAMI,GAAeF,EAAMJ,GAG7B,IAAIU,EAAgB,EAMpB,OAJIN,GAAOF,EAAMI,KACfI,GAAiBR,EAAMI,GAAeF,GAAO,KAGxCH,EAASvF,KAAKiG,KAAMR,EAAKrG,EAAM4G,IAI5BX,EAAS,QAAS,KAAK,SAAUI,EAAKrG,EAAMkG,GACxD,OAAIlG,EAAKsE,MAAMwC,IAAMZ,EAAO,EACnB,CACLQ,GAAW,MAAPR,GAGC,CACLQ,GAAIL,EAAIK,GAAK,QCpFnB,SAASK,EAAQ/G,GACf,IAAMgH,EAAShH,EAAK6F,IAAIoB,MAAK,SAACC,GAAD,MAAoB,WAAZA,EAAGrC,QACxC,OAAOmC,EAAOG,EAGT,SAASC,EAAcC,EAAQrH,GACpC,IAAMsH,EAAMD,EAAOE,WAAW,MACxBP,EAAShH,EAAK6F,IAAIoB,MAAK,SAACC,GAAD,MAAoB,WAAZA,EAAGrC,QAQxC,OANAwC,EAAOG,MAAmB,EAAXR,EAAOS,EACtBJ,EAAOK,OAAoB,EAAXV,EAAOW,EACvBN,EAAOO,MAAMJ,MAAb,UAAwBR,EAAOS,EAA/B,MACAJ,EAAOO,MAAMF,OAAb,UAAyBV,EAAOW,EAAhC,MACAL,EAAIO,MAAM,EAAG,GAENP,EAGF,SAASQ,EAAMC,EAAQV,GAC5B,IAAMC,EAAMD,EAAOE,WAAW,MAC9BD,EAAIU,UAAU,EAAG,EAAGX,EAAOG,MAAOH,EAAOK,QACzCJ,EAAIW,UAAUF,EAAQ,EAAG,EAAGV,EAAOG,MAAQ,EAAGH,EAAOK,OAAS,GAGhE,SAASQ,EAAUZ,EAAKtH,EAAM0C,GAC5B,IAAMsE,EAAShH,EAAK6F,IAAIoB,MAAK,SAACC,GAAD,MAAoB,WAAZA,EAAGrC,QAClCsC,EAAIzE,EAAEyE,EACNgB,EAAInB,EAAOW,EAAIjF,EAAEyF,EAAIzF,EAAEiF,EACvBH,EAAQ9E,EAAE+E,EACVC,EAAShF,EAAEiF,EAEjBL,EAAIc,UAAY1F,EAAE2F,MAEdrI,EAAKsE,MAAMU,gBAAkBtC,EAAE4F,cACjChB,EAAIc,UAAY,OAGlBd,EAAIiB,SAASpB,EAAIJ,EAAQ/G,GAAOmI,EAAGX,EAAOE,GAGrC,SAASc,EAAYlB,EAAKtH,GAC/B,IAAMyI,EAAYzI,EAAK6F,IAAI6C,QAAO,SAACxB,GAAD,OAChCA,EAAGyB,WAAWC,SAASpD,MAEnBwB,EAAShH,EAAK6F,IAAIoB,MAAK,SAACC,GAAD,MAAoB,WAAZA,EAAGrC,QACxC4D,EAAUI,SAAQ,SAACnG,GACjB4E,EAAIwB,YAAc,MAClBxB,EAAIyB,YACJ,IAAMC,EAAKtG,EAAEyE,EAAIJ,EAAQ/G,GAAQ0C,EAAE+E,EAAI,EACjCwB,EAAKjC,EAAOW,EAAIjF,EAAEyF,EAAIzF,EAAEiF,EAAIjF,EAAEiF,EAAI,EAElCuB,EAAY,GAAPxG,EAAEyG,GACPC,EAAY,GAAP1G,EAAEgE,GACbY,EAAI+B,OAAOL,EAAIC,GACf3B,EAAIgC,OAAON,EAAKE,EAAID,EAAKG,GACzB9B,EAAIiC,YAID,SAASC,EAAWlC,EAAKtH,GAC9B,IAAMgH,EAAShH,EAAK6F,IAAIoB,MAAK,SAACC,GAAD,MAAoB,WAAZA,EAAGrC,QAClC4D,EAAYzI,EAAK6F,IAAI6C,QAAO,SAACxB,GAAD,OAChCA,EAAGyB,WAAWC,SAASpD,MAEzBiD,EAAUI,SAAQ,SAACnG,GACjB4E,EAAIc,UAAY,OAChBd,EAAIiB,SAAS7F,EAAE+G,GAAK1C,EAAQ/G,GAAOgH,EAAOW,EAAIjF,EAAEgH,GAAKhH,EAAEiF,EAAGjF,EAAE+E,EAAG/E,EAAEiF,MAI9D,SAASgC,EAAUrC,EAAKtH,GAC7B,IAAMyI,EAAYzI,EAAK6F,IAAI6C,QAAO,SAACxB,GAAD,OAChCA,EAAGyB,WAAWC,SAASpD,MAEzBiD,EAAUI,SAAQ,SAACnG,GAAD,OAAOwF,EAAUZ,EAAKtH,EAAM0C,MAGzC,SAASkH,EAAatC,EAAKtH,GAChC,IAAMgH,EAAShH,EAAK6F,IAAIoB,MAAK,SAACC,GAAD,MAAoB,WAAZA,EAAGrC,QAExCyC,EAAIc,UAAY,UAChBd,EAAIuC,UAAY,SAChBvC,EAAIwC,KAAO,iBACXxC,EAAIyC,SAAS,YAAa/C,EAAOS,EAAI,EAAGT,EAAOW,EAAI,GAG9C,SAASqC,EAAY1C,EAAKtH,GAC/B,IAAMgH,EAAShH,EAAK6F,IAAIoB,MAAK,SAACC,GAAD,MAAoB,WAAZA,EAAGrC,QACxCyC,EAAIc,UAAY,UAChBd,EAAIuC,UAAY,SAChBvC,EAAIwC,KAAO,iBACXxC,EAAIyC,SACF/J,EAAKoE,OAAOK,UAAY,WAAa,cACrCuC,EAAOS,EAAI,EACXT,EAAOW,EAAI,GAIR,SAASsC,EAAK5C,EAAQrH,GAC3B,IAAMsH,EAAMD,EAAOE,WAAW,MAE9BD,EAAIU,UAAU,EAAG,EAAGX,EAAOG,MAAOH,EAAOK,QAErC1H,EAAKsE,MAAMS,YACbyE,EAAWlC,EAAKtH,GAGlB2J,EAAUrC,EAAKtH,GAEXA,EAAKsE,MAAMQ,aACb0D,EAAYlB,EAAKtH,GAGdA,EAAKsE,MAAM4F,SACdN,EAAatC,EAAKtH,GAGhBA,EAAKsE,MAAMC,UACbyF,EAAY1C,EAAKtH,GCrHrB,SAASmK,EAAM/H,GACbyE,KAAKzE,KAAOA,EACZyE,KAAKuD,UAAY,GAMnB,SAASC,IACPxD,KAAKyD,OAAS,GAkBT,SAASC,EAAKC,GACnB,KAAM3D,gBAAgB0D,GACpB,OAAO,IAAIA,EAAKC,GAElB3D,KAAKyD,OAAS,IAAID,EAClBxD,KAAKyD,OAAOG,cAAc,QAE1B5D,KAAK6D,SAAU,EACf7D,KAAK8D,KAAOpE,KAAKD,MACjBO,KAAK+D,OAAS,EACd/D,KAAKgE,MAAQhE,KAAKiE,KAAK1H,KAAKyD,MAExB2D,GACF3D,KAAKyD,OAAOS,iBAAiB,OAAQP,GApCzCL,EAAMzJ,UAAUsK,iBAAmB,SAAUC,GAC3CpE,KAAKuD,UAAUtJ,KAAKmK,IAOtBZ,EAAQ3J,UAAU+J,cAAgB,SAAUS,GAC1C,IAAMC,EAAQ,IAAIhB,EAAMe,GACxBrE,KAAKyD,OAAOY,GAAaC,GAG3Bd,EAAQ3J,UAAU0K,cAAgB,SAAUF,EAAWG,GACrDxE,KAAKyD,OAAOY,GAAWd,UAAUvB,SAAQ,SAAUoC,GACjDA,EAASI,OAIbhB,EAAQ3J,UAAUqK,iBAAmB,SAAUG,EAAWD,GACxDpE,KAAKyD,OAAOY,GAAWF,iBAAiBC,IAoB1CV,EAAK7J,UAAU4K,MAAQ,WACrB,IAAIzE,KAAK6D,QAMT,OAHA7D,KAAK6D,SAAU,EACf7D,KAAK8D,KAAOpE,KAAKD,MACjBO,KAAK+D,OAASW,sBAAsB1E,KAAKgE,OAClChE,MAGT0D,EAAK7J,UAAU8K,KAAO,WAMpB,OALA3E,KAAK6D,SAAU,EACK,IAAhB7D,KAAK+D,QACPa,qBAAqB5E,KAAK+D,QAE5B/D,KAAK+D,OAAS,EACP/D,MAGT0D,EAAK7J,UAAUoK,KAAO,WACpBjE,KAAK+D,OAASW,sBAAsB1E,KAAKgE,OACzC,IAAMa,EAAOnF,KAAKD,MACZqF,EAAKD,EAAO7E,KAAK8D,KACvB9D,KAAKyD,OAAOc,cAAc,OAAQO,GAClC9E,KAAK8D,KAAOe,G,gBC/DDE,EAAS,CACpB/G,KAAM,SACN8D,WAAY,GACZhB,EAAG,IACHF,EAAG,IACHN,EAAG,EACHgB,EAAG,EACHsB,GAAI,EACJC,GAAI,EACJP,GAAI,IACJzC,GAAI,GAGOmF,EAAQ,CACnBhH,KAAM,QACN8D,WAAY,CAACnD,GACbmC,EAAG,EACHF,EAAG,EACHN,EAAG,EACHgB,EAAG,GAGQ2D,EAAgBrL,OAAOsF,OAAO,GAAI8F,EAAO,CACpDhH,KAAM,WACNwD,MAAO,UACPM,WAAY,CAACvD,EAAaI,EAAeH,EAAiBC,KAG/CyG,EAAYtL,OAAOsF,OAAO,GAAI8F,EAAO,CAChDhH,KAAM,OACNwD,MAAO,UACPM,WAAY,CAACvD,EAAaI,EAAeH,KAG9B2G,GAAgBvL,OAAOsF,OAAO,GAAI8F,EAAO,CACpDhH,KAAM,WACNwD,MAAO,UACPM,WAAY,CAACvD,EAAaI,EAAeH,GACzCsC,EAAG,IAGQsE,GAAgBxL,OAAOsF,OAAO,GAAI8F,EAAO,CACpDhH,KAAM,WACNwD,MAAO,UACPM,WAAY,CAACvD,EAAaI,EAAeH,EAAiBE,KAG/C2G,GAAYzL,OAAOsF,OAAO,GAAI8F,EAAO,CAChDhH,KAAM,OACNwD,MAAO,UACPM,WAAY,CAACnD,EAAeH,GAC5BsC,EAAG,GACHF,EAAG,GACHN,EAAG,GACHsC,GAAI,EACJC,GAAI,EACJP,GAAI,IACJzC,GAAI,IAGC,SAASyF,KAUd,IAHA,IANAC,EAMA,uDANQ,GACRC,EAKA,uDALO,EACPC,EAIA,uDAJO,IACPC,EAGA,uDAHO,EACPC,EAEA,uDAFO,IACPpI,EACA,uDADS,GAEH+H,EAAS,GAEN7L,EAAI,EAAGA,EAAI8L,EAAO9L,IACzB6L,EAAOrL,KACLL,OAAOsF,OAAO,GAAI8F,EAAOzH,EAAQ,CAC/B+C,EAAGsF,KAAKC,UAAYJ,EAAOD,GAAQA,EACnClE,EAAGsE,KAAKC,UAAYF,EAAOD,GAAQA,EACnC9E,EAAmB,IAAhBgF,KAAKC,SACR/E,EAAG,EACH8B,GAAI,EACJC,GAAI,EACJP,IAAqB,GAAjBsD,KAAKC,SACThG,GAAI,KAKV,OAAOyF,E,oBC7FF,SAASQ,GAAMC,GACpB,OAAOA,EAAI,GAAGC,QAAQ,MAAO,IAAIA,QAAQ,WAAY,ICyDvD,IChDO,I,YAAMC,GAAS,CACpB1I,OAAQ,CACNhC,KAAM,UACNuC,YAAagI,GAAF,gGAGXlI,UAAW,UAEboB,IAAK,CACHpF,OAAOsF,OAAO,GAAI6F,GAClBnL,OAAOsF,OAAO,GAAIkG,GAAe,CAAExE,EAAG,IAAKE,EAAG,IAAKR,EAAG,KAAMgB,EAAG,KAF9D,sBAGEgE,GAAO,IAAK,EAAG,KAAM,IAAK,IAAK,CAAE9D,MAAO,aAH1C,CAID5H,OAAOsF,OAAO,GAAImG,GAAW,CAAE/E,EAAG,GAAIgB,EAAG,IACzC1H,OAAOsF,OAAO,GAAI+F,EAAe,CAAErE,EAAG,KAAMU,GAAI,MAChD1H,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,EAAGgB,EAAG,EAAGV,EAAG,OAClDhH,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,KAAMM,EAAG,MAC/ChH,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,KAAMM,EAAG,MAC/ChH,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,KAAMgB,EAAG,GAAIV,EAAG,MACtDhH,OAAOsF,OAAO,GAAI+F,EAAe,CAAErE,EAAG,GAAIU,EAAG,EAAGR,EAAG,GAAIR,EAAG,MAC1D1G,OAAOsF,OAAO,GAAI+F,EAAe,CAAErE,EAAG,GAAIU,EAAG,EAAGR,EAAG,GAAIR,EAAG,MAC1D1G,OAAOsF,OAAO,GAAI+F,EAAe,CAAErE,EAAG,GAAIU,EAAG,EAAGR,EAAG,GAAIR,EAAG,MAC1D1G,OAAOsF,OAAO,GAAI+F,EAAe,CAAErE,EAAG,GAAIU,EAAG,IAAKR,EAAG,KAAMR,EAAG,UAIrD4F,GAAS,CACpB3I,OAAQ,CACNhC,KAAM,UACNuC,YAAagI,GAAF,sDAGb9G,IAAK,CACHpF,OAAOsF,OAAO,GAAI6F,GAClBnL,OAAOsF,OAAO,GAAIkG,GAAe,CAAExE,EAAG,IAAKE,EAAG,IAAKR,EAAG,KAAMgB,EAAG,KAF9D,sBAGEgE,GAAO,IAAK,EAAG,KAAM,IAAK,IAAK,CAAE9D,MAAO,aAH1C,CAID5H,OAAOsF,OAAO,GAAImG,GAAW,CAAE/E,EAAG,GAAIgB,EAAG,IACzC1H,OAAOsF,OAAO,GAAI+F,EAAe,CAAErE,EAAG,KAAMU,GAAI,MAChD1H,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7D,EAAG,EAAGV,EAAG,MAC5ChH,OAAOsF,OAAO,GAAIiG,GAAe,CAAEvE,EAAG,IAAKN,EAAG,IAAKgB,EAAG,KACtD1H,OAAOsF,OAAO,GAAIiG,GAAe,CAAEvE,EAAG,IAAKN,EAAG,IAAKgB,EAAG,KACtD1H,OAAOsF,OAAO,GAAIiG,GAAe,CAAEvE,EAAG,GAAIN,EAAG,IAAMgB,EAAG,KACtD1H,OAAOsF,OAAO,GAAIiG,GAAe,CAAEvE,EAAG,GAAIN,EAAG,KAAMgB,EAAG,KACtD1H,OAAOsF,OAAO,GAAIiG,GAAe,CAAEvE,EAAG,GAAIN,EAAG,KAAMgB,EAAG,KACtD1H,OAAOsF,OAAO,GAAIiG,GAAe,CAAEvE,EAAG,GAAIN,EAAG,KAAMgB,EAAG,KACtD1H,OAAOsF,OAAO,GAAIiG,GAAe,CAAEvE,EAAG,IAAKN,EAAG,KAAMgB,EAAG,KACvD1H,OAAOsF,OAAO,GAAIiG,GAAe,CAAEvE,EAAG,IAAKN,EAAG,KAAMgB,EAAG,MACvD1H,OAAOsF,OAAO,GAAIiG,GAAe,CAAEvE,EAAG,IAAKN,EAAG,KAAMgB,EAAG,KACvD1H,OAAOsF,OAAO,GAAIiG,GAAe,CAAEvE,EAAG,IAAKN,EAAG,KAAMgB,EAAG,MACvD1H,OAAOsF,OAAO,GAAI+F,EAAe,CAAErE,EAAG,GAAIU,EAAG,IAAKR,EAAG,IAAMR,EAAG,OAC9D1G,OAAOsF,OAAO,GAAIiG,GAAe,CAAEvE,EAAG,IAAKN,EAAG,KAAMgB,EAAG,SDlD9C6E,I,UAAS,CACpBnH,IAAK,CACHpF,OAAOsF,OAAO,GAAI6F,GAClBnL,OAAOsF,OAAO,GAAImG,GAAW,CAAE/E,EAAG,GAAIgB,EAAG,IACzC1H,OAAOsF,OAAO,GAAI+F,EAAe,CAAErE,EAAG,MAAOU,GAAI,MAEjD1H,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,EAAGgB,EAAG,EAAGV,EAAG,MAClDhH,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,IAAKgB,EAAG,EAAGV,EAAG,MACpDhH,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,IAAKgB,EAAG,GAAIV,EAAG,SAI5CwF,GAAW,CACtB7I,OAAQ,CACNY,gBAAgB,EAChBL,YAAagI,GAAF,8KAMb9G,IAAK,CACHpF,OAAOsF,OAAO,GAAI6F,GAClBnL,OAAOsF,OAAO,GAAImG,GAAW,CAAE/E,EAAG,EAAGgB,EAAG,IAAKgB,GAAI,IACjD1I,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,EAAGgB,EAAG,IAAKV,EAAG,KACpDhH,OAAOsF,OAAO,GAAI+F,EAAe,CAAE3E,EAAG,EAAGgB,GAAI,IAAKV,EAAG,GAAIE,EAAG,SAInDuF,GAAmB,CAC9B9I,OAAQ,CACNO,YAAagI,GAAF,+FAGb9G,IAAK,CACHpF,OAAOsF,OAAO,GAAI6F,GAClBnL,OAAOsF,OAAO,GAAImG,GAAW,CAC3B/E,EAAG,GACHgB,EAAG,EACHgB,GAAI,KAEN1I,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,EAAGgB,EAAG,EAAGV,EAAG,MAClDhH,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,IAAKgB,EAAG,EAAGV,EAAG,EAAGE,EAAG,KAC1DlH,OAAOsF,OAAO,GAAI+F,EAAe,CAAE3E,EAAG,IAAKgB,EAAG,EAAGV,EAAG,GAAIE,EAAG,OAIzDwF,GAAgB,GAEb7M,GAAI,EAAGA,GAAI,GAAIA,KACtB6M,GAAcrM,KACZL,OAAOsF,OAAO,GAAI+F,EAAe,CAC/B3E,EAAG,IAAM,IAAM7G,GACf6H,EAAG,EACHV,EAAG,GACHE,EAAG,GAAKrH,GAAI,KAoDlB,IA/CO,IAAM8M,GAAO,CAClBvH,IAAK,CACHpF,OAAOsF,OAAO,GAAI6F,GAClBnL,OAAOsF,OAAO,GAAImG,GAAW,CAC3B/E,EAAG,GACHgB,EAAG,IAEL1H,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,EAAGgB,EAAG,EAAGV,EAAG,QAClDhH,OAAOsF,OAAO,GAAI+F,EAAe,CAAE3E,EAAG,EAAGgB,GAAI,IAAKV,EAAG,MAAOE,EAAG,KAP9D,OAQEwF,KAIME,GAAqB,CAChCjJ,OAAQ,CACNO,YAAagI,GAAF,gFAIb9G,IAAK,CACHpF,OAAOsF,OAAO,GAAI6F,GAClBnL,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,EAAGgB,EAAG,EAAGV,EAAG,MAElDhH,OAAOsF,OAAO,GAAImG,GAAW,CAAE/E,EAAG,GAAIgB,EAAG,EAAGgB,GAAI,IAChD1I,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,EAAGgB,EAAG,IAAKV,EAAG,MACpDhH,OAAOsF,OAAO,GAAI+F,EAAe,CAAE3E,EAAG,EAAGgB,EAAG,IAAKV,EAAG,IAAKE,EAAG,OAInD2F,GAAuB,CAClClJ,OAAQ,CACNO,YAAagI,GAAF,gEAIb9G,IAAK,CACHpF,OAAOsF,OAAO,GAAI6F,GAClBnL,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,EAAGgB,EAAG,EAAGV,EAAG,MAElDhH,OAAOsF,OAAO,GAAImG,GAAW,CAAE/E,EAAG,GAAIgB,EAAG,EAAGgB,GAAI,IAChD1I,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,GAAIgB,EAAG,GAAIV,EAAG,KACpDhH,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,GAAI,GAAIgB,EAAG,GAAIV,EAAG,OAIrD8F,GAAkB,GAEbjN,GAAI,EAAGA,GAAI,IAAKA,KACvBiN,GAAkBA,GAAgBC,OAAO,CACvC/M,OAAOsF,OAAO,GAAIiG,GAAe,CAC/B7E,EAAG,IAAM7G,GACT6H,EAAG,GACHV,EAAG,IAAMgG,OAAW,EAAJnN,QAsBtB,IAjBO,IAAMoN,GAAU,CACrBtJ,OAAQ,CACNY,gBAAgB,GAElBa,IAAK,CACHpF,OAAOsF,OAAO,GAAI6F,IADjB,sBAEE2B,IAFF,CAGD9M,OAAOsF,OAAO,GAAImG,GAAW,CAC3B/E,EAAG,GACHgB,EAAG,KAEL1H,OAAOsF,OAAO,GAAI+F,EAAe,CAAE3E,EAAG,EAAGgB,EAAG,EAAGV,EAAG,MAAOE,EAAG,QAI1DgG,GAAoB,GAEjBrN,GAAI,EAAGA,GAAI,GAAIA,KACtBqN,GAAkB7M,KAChBL,OAAOsF,OAAO,GAAIiG,GAAe,CAC/B7E,EAAG,IAAM,IAAM7G,GACf6H,EAAG,GACHV,EAAG,IAAMgG,OAAOnN,OAKf,IAAMsN,GAAY,CACvB/H,IAAK,CACHpF,OAAOsF,OAAO,GAAI6F,GAClBnL,OAAOsF,OAAO,GAAImG,GAAW,CAAE/E,EAAG,GAAIgB,EAAG,IACzC1H,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,EAAGgB,EAAG,EAAGV,EAAG,OAHjD,OAIEkG,GAJF,CAKDlN,OAAOsF,OAAO,GAAI+F,EAAe,CAAE3E,EAAG,EAAGgB,GAAI,IAAKV,EAAG,MAAOE,EAAG,OAItDkG,GAAc,CACzBhI,IAAK,CACHpF,OAAOsF,OAAO,GAAI6F,GAClBnL,OAAOsF,OAAO,GAAImG,GAAW,CAAE/E,EAAG,GAAIgB,EAAG,IACzC1H,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,EAAGgB,EAAG,EAAGV,EAAG,MAClDhH,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,IAAKgB,EAAG,GAAIV,EAAG,MACrDhH,OAAOsF,OAAO,GAAI+F,EAAe,CAAE3E,EAAG,IAAKgB,EAAG,EAAGV,EAAG,IAAKE,EAAG,KAC5DlH,OAAOsF,OAAO,GAAI+F,EAAe,CAAE3E,EAAG,EAAGgB,GAAI,IAAKV,EAAG,MAAOE,EAAG,MAItDmG,GAAiB,CAC5BjI,IAAK,CACHpF,OAAOsF,OAAO,GAAI6F,GAClBnL,OAAOsF,OAAO,GAAImG,GAAW,CAAE/E,EAAG,GAAIgB,EAAG,IACzC1H,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,EAAGgB,EAAG,EAAGV,EAAG,MAClDhH,OAAOsF,OAAO,GAAI+F,EAAe,CAAE3E,EAAG,IAAKgB,EAAG,EAAGV,EAAG,GAAIE,EAAG,KAC3DlH,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,IAAKgB,EAAG,IAAKV,EAAG,MACtDhH,OAAOsF,OAAO,GAAI+F,EAAe,CAAE3E,EAAG,IAAKgB,EAAG,GAAIV,EAAG,GAAIE,EAAG,MAC5DlH,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,IAAKgB,EAAG,IAAKV,EAAG,MACtDhH,OAAOsF,OAAO,GAAI+F,EAAe,CAAE3E,EAAG,IAAKgB,EAAG,EAAGV,EAAG,GAAIE,EAAG,KAC3DlH,OAAOsF,OAAO,GAAI+F,EAAe,CAAE3E,EAAG,EAAGgB,GAAI,IAAKV,EAAG,MAAOE,EAAG,MAKnE,SAASoG,GAAO3J,GAGd,IAFA,IAAM2J,EAAS,GAENzN,EAAI,EAAGA,GAAK8D,EAAOgI,MAAO9L,IAAK,CACtC,IAAMmH,EAAIrD,EAAO4J,UACX7G,EAAI/C,EAAO+C,EAAIM,EAAInH,EACnBqH,EAAIvD,EAAO6J,WAAa3N,EACxB4N,EAAYvG,EAAIvD,EAAO+J,IACvBC,EAAYjH,EAAI/C,EAAOiK,SAE7BN,EAAOjN,KAAKL,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAGiH,EAAWjG,EAAGR,EAAGF,OACnEsG,EAAOjN,KAAKL,OAAOsF,OAAO,GAAI+F,EAAe,CAAE3E,IAAGgB,EAAG,EAAGV,IAAGE,EAAGuG,KAGhE,OAAOH,EAGF,IAAMO,GAAiB,CAC5BzI,IAAK,CACHpF,OAAOsF,OAAO,GAAI6F,GAClBnL,OAAOsF,OAAO,GAAImG,GAAW,CAAE/E,EAAG,GAAIgB,EAAG,IACzC1H,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,EAAGgB,EAAG,EAAGV,EAAG,OAHjD,sBAIEsG,GAAO,CACR3B,MAAO,EACPjF,EAAG,IACHgB,EAAG,EACH8F,WAAY,GACZD,UAAW,IACXG,IAAK,GACLE,SAAU,MAXX,CAaD5N,OAAOsF,OAAO,GAAI+F,EAAe,CAAE3E,EAAG,EAAGgB,GAAI,IAAKV,EAAG,MAAOE,EAAG,OAItD4G,GAAiB,CAC5B1I,IAAK,CACHpF,OAAOsF,OAAO,GAAI6F,GAClBnL,OAAOsF,OAAO,GAAImG,GAAW,CAAE/E,EAAG,GAAIgB,EAAG,IACzC1H,OAAOsF,OAAO,GAAI+F,EAAe,CAAE3E,EAAG,EAAGgB,GAAI,IAAKV,EAAG,MAAOE,EAAG,IAE/DlH,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,EAAGgB,EAAG,EAAGV,EAAG,MAClDhH,OAAOsF,OAAO,GAAI+F,EAAe,CAAE3E,EAAG,IAAKgB,EAAG,IAAKV,EAAG,GAAIE,EAAG,MAC7DlH,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,IAAKgB,EAAG,EAAGV,EAAG,MAEpDhH,OAAOsF,OAAO,GAAI+F,EAAe,CAAE3E,EAAG,IAAKgB,EAAG,GAAIV,EAAG,GAAIE,EAAG,MAC5DlH,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,IAAKgB,EAAG,EAAGV,EAAG,QAI3C+G,GAAoB,CAC/B3I,IAAK,CACHpF,OAAOsF,OAAO,GAAI6F,GAClBnL,OAAOsF,OAAO,GAAImG,GAAW,CAAE/E,EAAG,GAAIgB,EAAG,IACzC1H,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,EAAGgB,EAAG,EAAGV,EAAG,MAClDhH,OAAOsF,OAAO,GAAI+F,EAAe,CAAE3E,EAAG,EAAGgB,GAAI,IAAKV,EAAG,MAAOE,EAAG,IAE/DlH,OAAOsF,OAAO,GAAI+F,EAAe,CAAE3E,EAAG,IAAKgB,EAAG,EAAGV,EAAG,GAAIE,EAAG,KAC3DlH,OAAOsF,OAAO,GAAI+F,EAAe,CAAE3E,EAAG,IAAKgB,EAAG,GAAIV,EAAG,GAAIE,EAAG,QAInD8G,GAAiB,CAC5B5I,IAAK,CACHpF,OAAOsF,OAAO,GAAI6F,GAClBnL,OAAOsF,OAAO,GAAImG,GAAW,CAAE/E,EAAG,GAAIgB,EAAG,KACzC1H,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,EAAGgB,EAAG,GAAIV,EAAG,MACnDhH,OAAOsF,OAAO,GAAI+F,EAAe,CAAE3E,EAAG,EAAGgB,GAAI,IAAKV,EAAG,MAAOE,EAAG,IAE/DlH,OAAOsF,OAAO,GAAI+F,EAAe,CAAE3E,EAAG,IAAKgB,EAAG,GAAIV,EAAG,GAAIE,EAAG,MAC5DlH,OAAOsF,OAAO,GAAIgG,EAAW,CAAE5E,EAAG,IAAKgB,EAAG,GAAIV,EAAG,GAAIE,EAAG,MACxDlH,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,IAAKgB,EAAG,GAAIV,EAAG,KACrDhH,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,IAAKgB,EAAG,GAAIV,EAAG,QAI5CiH,GAAe,CAC1B7I,IAAK,CACHpF,OAAOsF,OAAO,GAAI6F,GAClBnL,OAAOsF,OAAO,GAAImG,GAAW,CAAE/E,EAAG,GAAIgB,EAAG,IACzC1H,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,EAAGgB,EAAG,EAAGV,EAAG,OAClDhH,OAAOsF,OAAO,GAAI+F,EAAe,CAAE3E,EAAG,EAAGgB,GAAI,IAAKV,EAAG,MAAOE,EAAG,IAE/DlH,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,EAAGgB,EAAG,GAAIV,EAAG,MACnDhH,OAAOsF,OAAO,GAAIgG,EAAW,CAAE5E,EAAG,EAAGgB,EAAG,GAAIV,EAAG,IAAKE,EAAG,KACvDlH,OAAOsF,OAAO,GAAIgG,EAAW,CAAE5E,EAAG,IAAKgB,EAAG,GAAIV,EAAG,IAAKE,EAAG,KACzDlH,OAAOsF,OAAO,GAAIiG,GAAe,CAAE7E,EAAG,IAAMgB,EAAG,GAAIV,EAAG,MACtDhH,OAAOsF,OAAO,GAAIgG,EAAW,CAAE5E,EAAG,IAAMgB,EAAG,GAAIV,EAAG,IAAKE,EAAG,O,0BP9NxDgH,GAAS,IAAI,EACbC,GAAS,IAAIrE,EAEnB,SAASsE,GAAUF,EAAQrE,GACzB,IAAMwE,EAAM,GAQZ,OANAxE,EAAOzB,SAAQ,SAACsC,GACd2D,EAAI3D,GAAS,WAAmB,2BAAN4D,EAAM,yBAANA,EAAM,gBAC9BJ,EAAOK,YAAY,CAAE7D,QAAO4D,KAAMA,QAI/BD,EAGM,uBAAgB,CAC7BG,MAD6B,WAE3B,wBACKJ,GAAUF,GAAQ,CAAC,WAAY,kBAD5BO,EAAR,EAAQA,SAAUC,EAAlB,EAAkBA,aAIlB,SAASC,EAAMC,GACbpF,EAAKqF,EAAazM,MAAOwM,GACzBvH,EAAMwH,EAAazM,MAAOwE,EAAOxE,OAP7B,SAUS0M,IAVT,6FAUN,8FACEL,EAAS1K,EAAa3B,OADxB,2CAVM,wBAcN,SAAS4B,IACHD,EAAa3B,MAAMuB,OAAOK,YAC5BmK,GAAOpD,OACPxH,EAAMnB,MAAQ2B,EAAa3B,MAAMuB,OAAOK,UACxC8K,KAIJ,SAASC,EAAYC,GACnB,MAA4BA,EAAEzP,KAAtBmL,EAAR,EAAQA,MAAOkE,EAAf,EAAeA,SACfhL,EAAIxB,MAAQwM,EAEE,iBAAVlE,GACFiE,EAAMC,GAGHA,EAAS/K,MAAM4F,SAClB0E,GAAOpD,OAGK,aAAVL,IACF/D,EAAckI,EAAazM,MAAOwM,GAClCjI,EAAcC,EAAOxE,MAAOwM,GAE5BD,EAAMC,IAIV,IAAMK,EAAS,IAAIC,gBAAgBjM,OAAOkM,SAASC,QAAQ,GAErDjL,EAAQ8K,EAAOI,IAAI,SACnBxL,EAAQ,gBAAS,CACrBwC,IAAI,EACJhC,aAAa,EACbC,YAAY,EACZC,gBAAgB,IAEZf,EAASyB,EAAW,iCACrB,GACA,IAEC1B,EAAQ,gBAAI,UACdK,EAAM,gBAAI,CAAED,OAAQ,KAElBiD,EAAS,kBACTiI,EAAe,kBAEf9K,EAAe,iBAAS,WAC5B,OAAOP,EAAOD,EAAMnB,UA0CtB,OAvCA,iBAAU,WACRyM,EAAazM,MAAQwE,EAAOxE,MAAMkN,YAElCnB,GAAOtE,OAAOS,iBAAiB,QAAQ,SAACY,GAAD,OACrCwD,EAAa,iCAAK7K,GAAN,IAAaqH,WAG3BgD,GAAO5D,iBAAiB,WAAW,SAAC0E,GAAD,OAAOD,EAAYC,MAEtD,IAAMO,EAAc,WAClB1L,EAAMwC,IAAK,EAEPzC,EAAIxB,MAAMyB,QAAUD,EAAIxB,MAAMyB,MAAM4F,QACtCqF,IACUX,GAAOlE,SACjBkE,GAAOtD,SAIL2E,EAAgB,SAACR,GACrBA,EAAES,iBACFT,EAAEU,kBACF7L,EAAMwC,IAAK,GAGbsJ,SAASrF,iBAAiB,eAAe,SAAC0E,GAAD,OAAOA,EAAES,oBAClDE,SAASrF,iBAAiB,aAAciF,GACxCI,SAASrF,iBAAiB,UAAWiF,GACrCI,SAASrF,iBAAiB,WAAYkF,GACtCG,SAASrF,iBAAiB,QAASkF,MAGrC,iBAAY,WACVtB,GAAO0B,eAGT,gBAAM,SAAS,kBAAMd,MAAS,CAAEe,WAAW,IAC3C,gBAAM,SAAS,kBAAMlB,EAAM/K,EAAIxB,UAExB,CACL+B,QACAX,SACAD,QACAQ,eACAF,QACAD,MACAgD,SACA5C,gB,USjLN,GAAO8L,OAAS,EAChB,GAAOC,UAAY,kBAEJ,UVEA,kBAAgB,CAC7BC,WAAY,CACVC,SAGFtO,KAAM,Q,UWVR,GAAOmO,OAASA,EAED,UCJf,eAAUI,IAAKC,MAAM","file":"js/app.25509501.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Game.vue?vue&type=style&index=0&id=96c50728&scoped=true&lang=css\"","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./App.vue?vue&type=style&index=0&id=dd005110&lang=css\"","<template>\n  <div id=\"app\">\n    <game></game>\n  </div>\n</template>\n\n<script>\nimport { defineComponent } from \"vue\";\nimport Game from \"./components/Game.vue\";\n\nexport default defineComponent({\n  components: {\n    Game\n  },\n\n  name: 'app'\n})\n</script>\n\n<style>\n#app {\n  width: 300px;\n  margin: auto;\n  margin-top: 40px;\n  font-family: monospace;\n}\n\n* {\n  -webkit-touch-callout: none; /* iOS Safari */\n    -webkit-user-select: none; /* Safari */\n     -khtml-user-select: none; /* Konqueror HTML */\n       -moz-user-select: none; /* Firefox */\n        -ms-user-select: none; /* Internet Explorer/Edge */\n            user-select: none; /* Non-prefixed version, currently\n                                  supported by Chrome and Opera */\n}\n</style>\n","<template>\n  <div class=\"game\">\n    <div>\n      <select class=\"level-select\" v-model=\"level\">\n        <option :value=\"k\" v-for=\"(v, k) in levels\" :key=\"k\">\n          {{ v.config.name || k }}\n        </option>\n      </select>\n    </div>\n    <canvas ref=\"canvas\"></canvas>\n    <pre\n      v-if=\"dat.state && dat.state.isWinner && currentLevel.config.nextLevel\"\n    >\n      <a href=\"\" @click.prevent=\"nextLevel\">next level</a>\n    </pre>\n    <pre v-else>{{ currentLevel.config.description }}</pre>\n\n    <template v-if=\"debug\">\n      <label>\n        <input type=\"checkbox\" v-model=\"state.showVectors\" />\n        show vectors\n      </label>\n      <br />\n      <label>\n        <input type=\"checkbox\" v-model=\"state.showGhosts\" />\n        show ghosts\n      </label>\n      <br />\n      <label>\n        <input type=\"checkbox\" v-model=\"state.showCollisions\" />\n        show collisions\n      </label>\n    </template>\n  </div>\n</template>\n\n<script>\n// eslint-disable-next-line\nimport Worker from \"@/game.worker.js\";\nimport { loadLevels } from \"@/lib/engine\";\nimport { draw, prepareCanvas, flush } from \"@/lib/screen\";\nimport { Loop } from \"@/lib/loop\";\nimport * as mainLevels from \"@/maps/main\";\nimport * as testLevels from \"@/maps/tests\";\nimport {\n  computed,\n  defineComponent,\n  onMounted,\n  onUnmounted,\n  reactive,\n  ref,\n  watch,\n} from \"@vue/runtime-core\";\n\nconst worker = new Worker();\nconst engine = new Loop();\n\nfunction mapWorker(worker, events) {\n  const ret = {};\n\n  events.forEach((event) => {\n    ret[event] = function (...args) {\n      worker.postMessage({ event, args: args });\n    };\n  });\n\n  return ret;\n}\n\nexport default defineComponent({\n  setup() {\n    const { loadGame, requestFrame } = {\n      ...mapWorker(worker, [\"loadGame\", \"requestFrame\"]),\n    };\n\n    function _draw(response) {\n      draw(canvasBuffer.value, response);\n      flush(canvasBuffer.value, canvas.value);\n    }\n\n    async function reset() {\n      loadGame(currentLevel.value);\n    }\n\n    function nextLevel() {\n      if (currentLevel.value.config.nextLevel) {\n        engine.stop();\n        level.value = currentLevel.value.config.nextLevel;\n        reset();\n      }\n    }\n\n    function handleFrame(e) {\n      const { event, response } = e.data;\n      dat.value = response;\n\n      if (event === \"requestFrame\") {\n        _draw(response);\n      }\n\n      if (!response.state.isAlive) {\n        engine.stop();\n      }\n\n      if (event === \"loadGame\") {\n        prepareCanvas(canvasBuffer.value, response);\n        prepareCanvas(canvas.value, response);\n\n        _draw(response);\n      }\n    }\n\n    const params = new URLSearchParams(window.location.search, true);\n\n    const debug = params.has(\"debug\");\n    const state = reactive({\n      up: false,\n      showVectors: false,\n      showGhosts: false,\n      showCollisions: false,\n    });\n    const levels = loadLevels({\n      ...mainLevels,\n      ...testLevels,\n    });\n    const level = ref(\"level1\");\n    let dat = ref({ config: {} });\n\n    const canvas = ref();\n    const canvasBuffer = ref();\n\n    const currentLevel = computed(() => {\n      return levels[level.value];\n    });\n\n    onMounted(() => {\n      canvasBuffer.value = canvas.value.cloneNode();\n\n      engine.events.addEventListener(\"tick\", (dt) =>\n        requestFrame({ ...state, dt })\n      );\n\n      worker.addEventListener(\"message\", (e) => handleFrame(e));\n\n      const handlePress = () => {\n        state.up = true;\n\n        if (dat.value.state && !dat.value.state.isAlive) {\n          reset();\n        } else if (!engine.running) {\n          engine.start();\n        }\n      };\n\n      const handleRelease = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        state.up = false;\n      };\n\n      document.addEventListener(\"contextmenu\", (e) => e.preventDefault());\n      document.addEventListener(\"touchstart\", handlePress);\n      document.addEventListener(\"keydown\", handlePress);\n      document.addEventListener(\"touchend\", handleRelease);\n      document.addEventListener(\"keyup\", handleRelease);\n    });\n\n    onUnmounted(() => {\n      worker.terminate();\n    });\n\n    watch(\"level\", () => reset(), { immediate: true });\n    watch(\"state\", () => _draw(dat.value));\n\n    return {\n      debug,\n      levels,\n      level,\n      currentLevel,\n      state,\n      dat,\n      canvas,\n      nextLevel,\n    };\n  },\n});\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\n*:focus {\n  outline: none;\n}\n\nh1,\nh2 {\n  font-weight: normal;\n}\n\nul {\n  list-style-type: none;\n  padding: 0;\n}\n\nli {\n  display: inline-block;\n  margin: 0 10px;\n}\n\na {\n  color: #42b983;\n}\n\n.level-select {\n  appearance: none;\n  background: none;\n  border: none;\n  font-size: 1rem;\n  font-family: monospace;\n  margin-bottom: 0.5rem;\n}\n</style>\n","export default function Worker_fn() {\n  return new Worker(__webpack_public_path__ + \"js/game.worker.9101dfe8.worker.js\");\n}\n","import { intersects } from \"./collision\";\n\nexport const PROP_STATIC = \"static\";\nexport const PROP_COLLIDABLE = \"collideable\";\nexport const PROP_KILLER = \"killer\";\nexport const PROP_WIN_ZONE = \"win-zone\";\nexport const PROP_DRAWABLE = \"drawable\";\n\nconst BASE_CONFIG = {\n  name: \"\",\n  description: \"\",\n  showCollisions: false,\n  showVectors: false,\n  showGhosts: false,\n};\n\nexport function loadLevels(levels) {\n  for (let [k, v] of Object.entries(levels)) {\n    levels[k] = initializeLevel(v);\n  }\n  return levels;\n}\n\nexport function initializeLevel({ config, map }) {\n  const level = {\n    config: Object.freeze(Object.assign({}, BASE_CONFIG, config)),\n    map,\n  };\n\n  level.config = Object.freeze(level.config);\n\n  return level;\n}\n\nfunction getRectVertices(a) {\n  return {\n    a: { x: a.x, y: a.y },\n    b: { x: a.x, y: a.y + a.h },\n    c: { x: a.x + a.w, y: a.y + a.h },\n    d: { x: a.x + a.w, y: a.y },\n  };\n}\n\nfunction noop() {\n  // noop\n}\n\n// A throttling function with a few rules:\n//\n// - You must start burn while on the floor (dy == 0)\n// - Burn starts when global state is up\n// - Burn ends after timer, or when parent hits floor (dy == 0)\nfunction throttle(name, burn = 1000, burnFunc = noop) {\n  const _data = {};\n\n  return function _func(obj, data) {\n    const now = Date.now();\n    const burndownKey = `burndown`;\n    const timerKey = `timer`;\n\n    if (obj.dy === 0) {\n      clearTimeout(_data[timerKey]);\n      delete _data[burndownKey];\n    }\n\n    if (_data[burndownKey] == null) {\n      _data[burndownKey] = now + burn;\n    }\n\n    let burnRemaining = 0;\n\n    if (now <= _data[burndownKey]) {\n      burnRemaining = (_data[burndownKey] - now) / 1000;\n    }\n\n    return burnFunc.call(this, obj, data, burnRemaining);\n  };\n}\n\nconst accel = throttle(\"accel\", 500, function (obj, data, burn) {\n  if (data.state.up && burn > 0) {\n    return {\n      dy: burn * 1.001,\n    };\n  } else {\n    return {\n      dy: obj.dy - 0.08,\n    };\n  }\n});\n\nfunction furthestExtent(data) {\n  const extents = data.map.map((el) =>\n    el.properties.includes(PROP_STATIC) ? el.x + el.w : 0\n  );\n  const furthestExtent = Math.max(...extents);\n  return furthestExtent;\n}\n\nfunction atExtents(data) {\n  const camera = data.map.find((el) => el.type === \"camera\");\n\n  return camera.x + camera.w >= furthestExtent(data);\n}\n\nexport function move(data, state) {\n  data.state = { ...data.state, ...state };\n\n  const hero = data.map.find((el) => el.type === \"hero\");\n  Object.assign(hero, accel(hero, data));\n\n  data.map = data.map.map((el) => {\n    const obj = Object.assign({}, el);\n\n    if (!obj.properties.includes(PROP_STATIC)) {\n      obj.x0 = el.x;\n      obj.y0 = el.y;\n\n      obj.x += state.dt * el.dx;\n      obj.y += state.dt * el.dy;\n    }\n\n    return obj;\n  });\n\n  if (atExtents(data)) {\n    const camera = data.map.find((el) => el.type === \"camera\");\n    camera.x = furthestExtent(data) - camera.w;\n  }\n\n  return data;\n}\n\nexport function isJumping(data) {\n  const hero = data.map.find((el) => el.type === \"hero\");\n  return hero.dy !== 0;\n}\n\nfunction _detectCollision(a, b) {\n  const aV = getRectVertices(a);\n  const a0V = getRectVertices(Object.assign({}, a, { x: a.x0, y: a.y0 }));\n  const bV = getRectVertices(b);\n\n  const sides = [\n    [\"a\", \"b\"],\n    [\"b\", \"c\"],\n    [\"c\", \"d\"],\n    [\"d\", \"a\"],\n  ];\n\n  for (const ai in sides) {\n    if (ai) {\n      const aSide = sides[ai];\n      for (const bi in sides) {\n        if (bi) {\n          const bSide = sides[bi];\n\n          const intersection =\n            intersects(\n              aV[aSide[0]],\n              a0V[aSide[0]],\n              bV[bSide[0]],\n              bV[bSide[1]]\n            ) ||\n            intersects(\n              aV[aSide[0]],\n              aV[aSide[1]],\n              bV[bSide[0]],\n              bV[bSide[1]]\n            ) ||\n            intersects(\n              a0V[aSide[0]],\n              a0V[aSide[1]],\n              bV[bSide[0]],\n              bV[bSide[1]]\n            ) ||\n            intersects(\n              a0V[aSide[0]],\n              a0V[aSide[1]],\n              bV[bSide[0]],\n              bV[bSide[1]]\n            );\n\n          if (intersection) {\n            return [intersection, bSide.join(\"\")];\n          }\n        }\n      }\n    }\n  }\n\n  return null;\n}\n\nexport function detectCollision(data, map) {\n  const collisions = [];\n  const collidables = {\n    heros: [],\n    static: [],\n  };\n  map.reduce((m, o) => {\n    if (\n      !o.properties.includes(PROP_STATIC) &&\n      o.properties.includes(PROP_COLLIDABLE)\n    ) {\n      m.heros.push(o);\n    } else if (o.properties.includes(PROP_COLLIDABLE)) {\n      m.static.push(o);\n    }\n    return m;\n  }, collidables);\n\n  if (data.state.showCollisions) {\n    map.forEach((o) => {\n      o.inCollision = false;\n    });\n  }\n\n  collidables.heros.forEach((a) => {\n    collidables.static.forEach((o) => {\n      if (a === o) {\n        return;\n      }\n\n      const collision = _detectCollision(a, o);\n      if (collision) {\n        const [intersection, side] = collision;\n\n        if (data.state.showCollisions) {\n          a.inCollision = true;\n          o.inCollision = true;\n        }\n\n        collisions.push([a, o, intersection, side]);\n      }\n    });\n  });\n\n  return collisions;\n}\n\nfunction pathag(a, b) {\n  return Math.sqrt(Math.pow(a, 2) + Math.pow(b, 2));\n}\n\nfunction sortCollisions(a, b) {\n  const da = pathag(a[2].dx, a[2].dy);\n  const db = pathag(b[2].dx, b[2].dy);\n\n  if (da < db) {\n    return -1;\n  }\n\n  if (da > db) {\n    return 1;\n  }\n\n  return 0;\n}\n\nfunction filterCollisions(collision) {\n  const collisionDistance = pathag(collision[2].dx, collision[2].dy);\n  return collisionDistance > 0.1;\n}\n\nexport function handleCollisions(data, collisions) {\n  if ((collisions && collisions.length === 0) || data.state.isWinner === true) {\n    return data;\n  }\n\n  const closestCollision = collisions.sort(sortCollisions)[0];\n  const nearCollisions = collisions.filter(filterCollisions, {});\n\n  // Allow hero to move once per axis, this is to handle pinch points between\n  // two static objects and a collider. This is necessary to prevent the\n  // movement of the same hero along a single axis. This could be avoided if\n  // the data model was immutable.\n  let hasMovedX = false;\n  let hasMovedY = false;\n\n  [closestCollision, ...nearCollisions].forEach((col) => {\n    const [hero, collision, intersection, side] = col;\n\n    if (collision.type === \"platform\" && hero.dy < 0) {\n      hero.y += intersection.dy;\n      hero.dy = 0;\n    }\n\n    if (collision.properties.includes(PROP_KILLER)) {\n      data.state.isAlive = false;\n    }\n\n    if (collision.properties.includes(PROP_WIN_ZONE)) {\n      data.state.isWinner = true;\n    }\n\n    if (collision.properties.includes(PROP_COLLIDABLE)) {\n      if (side === \"da\" && hasMovedY === false) {\n        hero.y += intersection.dy - hero.h;\n        hasMovedY = true;\n      } else if (side === \"ab\" && hasMovedX === false) {\n        hero.x += intersection.dx - hero.w;\n        hasMovedX = true;\n      } else if (side === \"bc\" && hero.dy < 0 && hasMovedY === false) {\n        hero.y += intersection.dy;\n        hasMovedY = true;\n      } else if (side === \"cd\" && hasMovedX === false) {\n        hero.x += intersection.dx;\n        hasMovedX = true;\n      }\n    }\n  });\n\n  return data;\n}\n\nexport function createFrame(data) {\n  // turn data into a single flat frame filled with objects to paint\n  return data;\n}\n","import { PROP_DRAWABLE } from \"./engine\";\n\nfunction cameraX(data) {\n  const camera = data.map.find((el) => el.type === \"camera\");\n  return camera.x;\n}\n\nexport function prepareCanvas(canvas, data) {\n  const ctx = canvas.getContext(\"2d\");\n  const camera = data.map.find((el) => el.type === \"camera\");\n\n  canvas.width = camera.w * 2;\n  canvas.height = camera.h * 2;\n  canvas.style.width = `${camera.w}px`;\n  canvas.style.height = `${camera.h}px`;\n  ctx.scale(2, 2);\n\n  return ctx;\n}\n\nexport function flush(buffer, canvas) {\n  const ctx = canvas.getContext(\"2d\");\n  ctx.clearRect(0, 0, canvas.width, canvas.height);\n  ctx.drawImage(buffer, 0, 0, canvas.width / 2, canvas.height / 2);\n}\n\nfunction _drawRect(ctx, data, r) {\n  const camera = data.map.find((el) => el.type === \"camera\");\n  const x = r.x;\n  const y = camera.h - r.y - r.h;\n  const width = r.w;\n  const height = r.h;\n\n  ctx.fillStyle = r.color;\n\n  if (data.state.showCollisions && r.inCollision) {\n    ctx.fillStyle = \"red\";\n  }\n\n  ctx.fillRect(x - cameraX(data), y, width, height);\n}\n\nexport function drawVectors(ctx, data) {\n  const drawables = data.map.filter((el) =>\n    el.properties.includes(PROP_DRAWABLE)\n  );\n  const camera = data.map.find((el) => el.type === \"camera\");\n  drawables.forEach((r) => {\n    ctx.strokeStyle = \"red\";\n    ctx.beginPath();\n    const cx = r.x - cameraX(data) + r.w / 2;\n    const cy = camera.h - r.y - r.h + r.h / 2;\n\n    const vx = r.dx * 50;\n    const vy = r.dy * 50;\n    ctx.moveTo(cx, cy);\n    ctx.lineTo(cx + vx, cy - vy);\n    ctx.stroke();\n  });\n}\n\nexport function drawGhosts(ctx, data) {\n  const camera = data.map.find((el) => el.type === \"camera\");\n  const drawables = data.map.filter((el) =>\n    el.properties.includes(PROP_DRAWABLE)\n  );\n  drawables.forEach((r) => {\n    ctx.fillStyle = \"blue\";\n    ctx.fillRect(r.x0 - cameraX(data), camera.h - r.y0 - r.h, r.w, r.h);\n  });\n}\n\nexport function drawRects(ctx, data) {\n  const drawables = data.map.filter((el) =>\n    el.properties.includes(PROP_DRAWABLE)\n  );\n  drawables.forEach((r) => _drawRect(ctx, data, r));\n}\n\nexport function drawGameOver(ctx, data) {\n  const camera = data.map.find((el) => el.type === \"camera\");\n\n  ctx.fillStyle = \"#333333\";\n  ctx.textAlign = \"center\";\n  ctx.font = \"24px monospace\";\n  ctx.fillText(\"Game Over\", camera.w / 2, camera.h / 2);\n}\n\nexport function drawGameWon(ctx, data) {\n  const camera = data.map.find((el) => el.type === \"camera\");\n  ctx.fillStyle = \"#efefef\";\n  ctx.textAlign = \"center\";\n  ctx.font = \"24px monospace\";\n  ctx.fillText(\n    data.config.nextLevel ? \"You Win!\" : \"Kill Screen\",\n    camera.w / 2,\n    camera.h / 2\n  );\n}\n\nexport function draw(canvas, data) {\n  const ctx = canvas.getContext(\"2d\");\n\n  ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n  if (data.state.showGhosts) {\n    drawGhosts(ctx, data);\n  }\n\n  drawRects(ctx, data);\n\n  if (data.state.showVectors) {\n    drawVectors(ctx, data);\n  }\n\n  if (!data.state.isAlive) {\n    drawGameOver(ctx, data);\n  }\n\n  if (data.state.isWinner) {\n    drawGameWon(ctx, data);\n  }\n}\n","// taken from https://github.com/mattdesl/raf-loop/blob/master/index.js\n// modified to remove external dependencies\n\nfunction Event(name) {\n  this.name = name;\n  this.callbacks = [];\n}\nEvent.prototype.registerCallback = function (callback) {\n  this.callbacks.push(callback);\n};\n\nfunction Reactor() {\n  this.events = {};\n}\n\nReactor.prototype.registerEvent = function (eventName) {\n  const event = new Event(eventName);\n  this.events[eventName] = event;\n};\n\nReactor.prototype.dispatchEvent = function (eventName, eventArgs) {\n  this.events[eventName].callbacks.forEach(function (callback) {\n    callback(eventArgs);\n  });\n};\n\nReactor.prototype.addEventListener = function (eventName, callback) {\n  this.events[eventName].registerCallback(callback);\n};\n\nexport function Loop(fn) {\n  if (!(this instanceof Loop)) {\n    return new Loop(fn);\n  }\n  this.events = new Reactor();\n  this.events.registerEvent(\"tick\");\n\n  this.running = false;\n  this.last = Date.now();\n  this._frame = 0;\n  this._tick = this.tick.bind(this);\n\n  if (fn) {\n    this.events.addEventListener(\"tick\", fn);\n  }\n}\n\nLoop.prototype.start = function () {\n  if (this.running) {\n    return;\n  }\n  this.running = true;\n  this.last = Date.now();\n  this._frame = requestAnimationFrame(this._tick);\n  return this;\n};\n\nLoop.prototype.stop = function () {\n  this.running = false;\n  if (this._frame !== 0) {\n    cancelAnimationFrame(this._frame);\n  }\n  this._frame = 0;\n  return this;\n};\n\nLoop.prototype.tick = function () {\n  this._frame = requestAnimationFrame(this._tick);\n  const time = Date.now();\n  const dt = time - this.last;\n  this.events.dispatchEvent(\"tick\", dt);\n  this.last = time;\n};\n","import {\n  PROP_STATIC,\n  PROP_COLLIDABLE,\n  PROP_KILLER,\n  PROP_WIN_ZONE,\n  PROP_DRAWABLE,\n} from \"./engine\";\n\nexport const CAMERA = {\n  type: \"camera\",\n  properties: [],\n  h: 300,\n  w: 300,\n  x: 0,\n  y: 0,\n  x0: 0,\n  y0: 0,\n  dx: 0.25,\n  dy: 0,\n};\n\nexport const SHAPE = {\n  type: \"shape\",\n  properties: [PROP_DRAWABLE],\n  h: 0,\n  w: 0,\n  x: 0,\n  y: 0,\n};\n\nexport const BASE_OBSTACLE = Object.assign({}, SHAPE, {\n  type: \"obstacle\",\n  color: \"#333333\",\n  properties: [PROP_STATIC, PROP_DRAWABLE, PROP_COLLIDABLE, PROP_KILLER],\n});\n\nexport const BASE_WALL = Object.assign({}, SHAPE, {\n  type: \"wall\",\n  color: \"#999999\",\n  properties: [PROP_STATIC, PROP_DRAWABLE, PROP_COLLIDABLE],\n});\n\nexport const BASE_PLATFORM = Object.assign({}, SHAPE, {\n  type: \"platform\",\n  color: \"#333333\",\n  properties: [PROP_STATIC, PROP_DRAWABLE, PROP_COLLIDABLE],\n  h: 1,\n});\n\nexport const BASE_WIN_ZONE = Object.assign({}, SHAPE, {\n  type: \"win-zone\",\n  color: \"#454545\",\n  properties: [PROP_STATIC, PROP_DRAWABLE, PROP_COLLIDABLE, PROP_WIN_ZONE],\n});\n\nexport const BASE_HERO = Object.assign({}, SHAPE, {\n  type: \"hero\",\n  color: \"#333333\",\n  properties: [PROP_DRAWABLE, PROP_COLLIDABLE],\n  h: 10,\n  w: 10,\n  x: 30,\n  x0: 0,\n  y0: 0,\n  dx: 0.25,\n  dy: 0,\n});\n\nexport function clouds(\n  count = 10,\n  xMin = 0,\n  xMax = 100,\n  yMin = 0,\n  yMax = 100,\n  config = {}\n) {\n  const clouds = [];\n\n  for (let i = 0; i < count; i++) {\n    clouds.push(\n      Object.assign({}, SHAPE, config, {\n        x: Math.random() * (xMax - xMin) + xMin,\n        y: Math.random() * (yMax - yMin) + yMin,\n        w: Math.random() * 100,\n        h: 1,\n        x0: 0,\n        y0: 0,\n        dx: Math.random() * -0.1,\n        dy: 0,\n      })\n    );\n  }\n\n  return clouds;\n}\n","export function strip(str) {\n  return str[0].replace(/^\\n/, \"\").replace(/^(\\s+)/gm, \"\");\n}\n","import {\n  BASE_HERO,\n  BASE_OBSTACLE,\n  BASE_PLATFORM,\n  BASE_WALL,\n  CAMERA,\n} from \"@/lib/build-tools\";\nimport { strip } from \"@/utils/string\";\n\nexport const ladder = {\n  map: [\n    Object.assign({}, CAMERA),\n    Object.assign({}, BASE_HERO, { x: 30, y: 1 }),\n    Object.assign({}, BASE_OBSTACLE, { w: 99999, y: -100 }),\n\n    Object.assign({}, BASE_PLATFORM, { x: 0, y: 0, w: 300 }),\n    Object.assign({}, BASE_PLATFORM, { x: 200, y: 6, w: 300 }),\n    Object.assign({}, BASE_PLATFORM, { x: 400, y: 11, w: 300 }),\n  ],\n};\n\nexport const fallTest = {\n  config: {\n    showCollisions: true,\n    description: strip`\n      demonstrates issues with collision\n      detection around two near collidables\n\n      play a few times to see the various responses`,\n  },\n  map: [\n    Object.assign({}, CAMERA),\n    Object.assign({}, BASE_HERO, { x: 2, y: 180, dx: 0 }),\n    Object.assign({}, BASE_PLATFORM, { x: 0, y: 110, w: 14 }),\n    Object.assign({}, BASE_OBSTACLE, { x: 0, y: -999, w: 14, h: 999 + 100 }),\n  ],\n};\n\nexport const verticalPlatform = {\n  config: {\n    description: strip`\n      Platforms do not handle horizontal collisions very well`,\n  },\n  map: [\n    Object.assign({}, CAMERA),\n    Object.assign({}, BASE_HERO, {\n      x: 30,\n      y: 1,\n      dx: 0.3,\n    }),\n    Object.assign({}, BASE_PLATFORM, { x: 0, y: 0, w: 300 }),\n    Object.assign({}, BASE_PLATFORM, { x: 200, y: 0, w: 1, h: 50 }),\n    Object.assign({}, BASE_OBSTACLE, { x: 250, y: 0, w: 10, h: 50 }),\n  ],\n};\n\nconst jumpObstacles = [];\n\nfor (let i = 0; i < 30; i++) {\n  jumpObstacles.push(\n    Object.assign({}, BASE_OBSTACLE, {\n      x: 200 + 300 * i,\n      y: 0,\n      w: 10,\n      h: 10 * i + 1,\n    })\n  );\n}\n\nexport const jump = {\n  map: [\n    Object.assign({}, CAMERA),\n    Object.assign({}, BASE_HERO, {\n      x: 30,\n      y: 1,\n    }),\n    Object.assign({}, BASE_PLATFORM, { x: 0, y: 0, w: 99999 }),\n    Object.assign({}, BASE_OBSTACLE, { x: 0, y: -100, w: 99999, h: 0 }),\n    ...jumpObstacles,\n  ],\n};\n\nexport const impossiblePlatform = {\n  config: {\n    description: strip`\n    this platform shouldn't be reachable\n    `,\n  },\n  map: [\n    Object.assign({}, CAMERA),\n    Object.assign({}, BASE_PLATFORM, { x: 0, y: 0, w: 300 }),\n\n    Object.assign({}, BASE_HERO, { x: 30, y: 1, dx: 0 }),\n    Object.assign({}, BASE_PLATFORM, { x: 0, y: 140, w: 150 }),\n    Object.assign({}, BASE_OBSTACLE, { x: 0, y: 270, w: 150, h: 20 }),\n  ],\n};\n\nexport const impossibleTrampoline = {\n  config: {\n    description: strip`\n    Bounce bounce bounce\n    `,\n  },\n  map: [\n    Object.assign({}, CAMERA),\n    Object.assign({}, BASE_PLATFORM, { x: 0, y: 0, w: 300 }),\n\n    Object.assign({}, BASE_HERO, { x: 30, y: 1, dx: 0 }),\n    Object.assign({}, BASE_PLATFORM, { x: 40, y: 50, w: 50 }),\n    Object.assign({}, BASE_PLATFORM, { x: -20, y: 50, w: 50 }),\n  ],\n};\n\nlet thinGapMapItems = [];\n\nfor (let i = 0; i < 500; i++) {\n  thinGapMapItems = thinGapMapItems.concat([\n    Object.assign({}, BASE_PLATFORM, {\n      x: 100 * i,\n      y: 50,\n      w: 100 - Number(i * 2),\n    }),\n  ]);\n}\n\nexport const thinGap = {\n  config: {\n    showCollisions: true,\n  },\n  map: [\n    Object.assign({}, CAMERA),\n    ...thinGapMapItems,\n    Object.assign({}, BASE_HERO, {\n      x: 30,\n      y: 52,\n    }),\n    Object.assign({}, BASE_OBSTACLE, { x: 0, y: 0, w: 99999, h: 10 }),\n  ],\n};\n\nconst chunkPadsMapItems = [];\n\nfor (let i = 0; i < 50; i++) {\n  chunkPadsMapItems.push(\n    Object.assign({}, BASE_PLATFORM, {\n      x: 450 + 150 * i,\n      y: 50,\n      w: 100 - Number(i),\n    })\n  );\n}\n\nexport const chunkPads = {\n  map: [\n    Object.assign({}, CAMERA),\n    Object.assign({}, BASE_HERO, { x: 30, y: 1 }),\n    Object.assign({}, BASE_PLATFORM, { x: 0, y: 0, w: 450 }),\n    ...chunkPadsMapItems,\n    Object.assign({}, BASE_OBSTACLE, { x: 0, y: -100, w: 99999, h: 0 }),\n  ],\n};\n\nexport const chunkBedHop = {\n  map: [\n    Object.assign({}, CAMERA),\n    Object.assign({}, BASE_HERO, { x: 30, y: 1 }),\n    Object.assign({}, BASE_PLATFORM, { x: 0, y: 0, w: 900 }),\n    Object.assign({}, BASE_PLATFORM, { x: 450, y: 50, w: 200 }),\n    Object.assign({}, BASE_OBSTACLE, { x: 400, y: 0, w: 300, h: 20 }),\n    Object.assign({}, BASE_OBSTACLE, { x: 0, y: -100, w: 99999, h: 0 }),\n  ],\n};\n\nexport const chunkTreeTrunk = {\n  map: [\n    Object.assign({}, CAMERA),\n    Object.assign({}, BASE_HERO, { x: 30, y: 1 }),\n    Object.assign({}, BASE_PLATFORM, { x: 0, y: 0, w: 900 }),\n    Object.assign({}, BASE_OBSTACLE, { x: 450, y: 0, w: 20, h: 60 }),\n    Object.assign({}, BASE_PLATFORM, { x: 500, y: 100, w: 100 }),\n    Object.assign({}, BASE_OBSTACLE, { x: 600, y: 30, w: 20, h: 150 }),\n    Object.assign({}, BASE_PLATFORM, { x: 620, y: 150, w: 100 }),\n    Object.assign({}, BASE_OBSTACLE, { x: 700, y: 0, w: 20, h: 80 }),\n    Object.assign({}, BASE_OBSTACLE, { x: 0, y: -100, w: 99999, h: 0 }),\n  ],\n};\n\n// should probably make this more generic and just call it a \"repeatable\"\nfunction stairs(config) {\n  const stairs = [];\n\n  for (let i = 1; i <= config.count; i++) {\n    const w = config.stepWidth;\n    const x = config.x + w * i;\n    const h = config.stepHeight * i;\n    const obstacleH = h - config.gap;\n    const platformX = x - config.overhang;\n\n    stairs.push(Object.assign({}, BASE_PLATFORM, { x: platformX, y: h, w }));\n    stairs.push(Object.assign({}, BASE_OBSTACLE, { x, y: 0, w, h: obstacleH }));\n  }\n\n  return stairs;\n}\n\nexport const chunkStairCase = {\n  map: [\n    Object.assign({}, CAMERA),\n    Object.assign({}, BASE_HERO, { x: 30, y: 1 }),\n    Object.assign({}, BASE_PLATFORM, { x: 0, y: 0, w: 900 }),\n    ...stairs({\n      count: 4,\n      x: 450,\n      y: 0,\n      stepHeight: 30,\n      stepWidth: 150,\n      gap: 10,\n      overhang: 75,\n    }),\n    Object.assign({}, BASE_OBSTACLE, { x: 0, y: -100, w: 99999, h: 0 }),\n  ],\n};\n\nexport const chunkTightLeap = {\n  map: [\n    Object.assign({}, CAMERA),\n    Object.assign({}, BASE_HERO, { x: 30, y: 1 }),\n    Object.assign({}, BASE_OBSTACLE, { x: 0, y: -100, w: 99999, h: 0 }),\n\n    Object.assign({}, BASE_PLATFORM, { x: 0, y: 0, w: 400 }),\n    Object.assign({}, BASE_OBSTACLE, { x: 450, y: 120, w: 20, h: 300 }),\n    Object.assign({}, BASE_PLATFORM, { x: 520, y: 0, w: 300 }),\n\n    Object.assign({}, BASE_OBSTACLE, { x: 840, y: 80, w: 20, h: 300 }),\n    Object.assign({}, BASE_PLATFORM, { x: 880, y: 0, w: 300 }),\n  ],\n};\n\nexport const chunkFlamingDeath = {\n  map: [\n    Object.assign({}, CAMERA),\n    Object.assign({}, BASE_HERO, { x: 30, y: 1 }),\n    Object.assign({}, BASE_PLATFORM, { x: 0, y: 0, w: 500 }),\n    Object.assign({}, BASE_OBSTACLE, { x: 0, y: -100, w: 99999, h: 0 }),\n\n    Object.assign({}, BASE_OBSTACLE, { x: 290, y: 0, w: 20, h: 40 }),\n    Object.assign({}, BASE_OBSTACLE, { x: 290, y: 80, w: 20, h: 300 }),\n  ],\n};\n\nexport const chunkShortDrop = {\n  map: [\n    Object.assign({}, CAMERA),\n    Object.assign({}, BASE_HERO, { x: 30, y: 51 }),\n    Object.assign({}, BASE_PLATFORM, { x: 0, y: 50, w: 250 }),\n    Object.assign({}, BASE_OBSTACLE, { x: 0, y: -100, w: 99999, h: 0 }),\n\n    Object.assign({}, BASE_OBSTACLE, { x: 290, y: 55, w: 20, h: 300 }),\n    Object.assign({}, BASE_WALL, { x: 450, y: 80, w: 10, h: 300 }),\n    Object.assign({}, BASE_PLATFORM, { x: 275, y: 10, w: 50 }),\n    Object.assign({}, BASE_PLATFORM, { x: 400, y: 80, w: 500 }),\n  ],\n};\n\nexport const chunkWallGap = {\n  map: [\n    Object.assign({}, CAMERA),\n    Object.assign({}, BASE_HERO, { x: 30, y: 1 }),\n    Object.assign({}, BASE_PLATFORM, { x: 0, y: 0, w: 1500 }),\n    Object.assign({}, BASE_OBSTACLE, { x: 0, y: -100, w: 99999, h: 0 }),\n\n    Object.assign({}, BASE_PLATFORM, { x: 0, y: 80, w: 900 }),\n    Object.assign({}, BASE_WALL, { x: 0, y: 70, w: 400, h: 10 }),\n    Object.assign({}, BASE_WALL, { x: 500, y: 70, w: 400, h: 10 }),\n    Object.assign({}, BASE_PLATFORM, { x: 1000, y: 80, w: 500 }),\n    Object.assign({}, BASE_WALL, { x: 1000, y: 70, w: 500, h: 10 }),\n  ],\n};\n","import {\n  clouds,\n  CAMERA,\n  BASE_HERO,\n  BASE_OBSTACLE,\n  BASE_PLATFORM,\n  BASE_WIN_ZONE,\n} from \"@/lib/build-tools\";\nimport { strip } from \"@/utils/string\";\n\nexport const level1 = {\n  config: {\n    name: \"Level 1\",\n    description: strip`\n      press any button to begin\n      press any button to jump`,\n    nextLevel: \"level2\",\n  },\n  map: [\n    Object.assign({}, CAMERA),\n    Object.assign({}, BASE_WIN_ZONE, { w: 300, h: 300, x: 2050, y: 0 }),\n    ...clouds(100, 0, 2350, 150, 300, { color: \"#dfdfdf\" }),\n    Object.assign({}, BASE_HERO, { x: 30, y: 1 }),\n    Object.assign({}, BASE_OBSTACLE, { w: 2350, y: -100 }),\n    Object.assign({}, BASE_PLATFORM, { x: 0, y: 0, w: 1200 }),\n    Object.assign({}, BASE_PLATFORM, { x: 1250, w: 300 }),\n    Object.assign({}, BASE_PLATFORM, { x: 1800, w: 500 }),\n    Object.assign({}, BASE_PLATFORM, { x: 1450, y: 50, w: 400 }),\n    Object.assign({}, BASE_OBSTACLE, { w: 20, y: 0, h: 10, x: 450 }),\n    Object.assign({}, BASE_OBSTACLE, { w: 20, y: 0, h: 10, x: 750 }),\n    Object.assign({}, BASE_OBSTACLE, { w: 20, y: 0, h: 50, x: 900 }),\n    Object.assign({}, BASE_OBSTACLE, { w: 20, y: 150, h: 1500, x: 1800 }),\n  ],\n};\n\nexport const level2 = {\n  config: {\n    name: \"Level 2\",\n    description: strip`\n      Rinse & repeat`,\n  },\n  map: [\n    Object.assign({}, CAMERA),\n    Object.assign({}, BASE_WIN_ZONE, { w: 300, h: 300, x: 3200, y: 0 }),\n    ...clouds(100, 0, 3500, 150, 300, { color: \"#dfdfdf\" }),\n    Object.assign({}, BASE_HERO, { x: 30, y: 1 }),\n    Object.assign({}, BASE_OBSTACLE, { w: 3500, y: -100 }),\n    Object.assign({}, BASE_PLATFORM, { y: 0, w: 300 }),\n    Object.assign({}, BASE_PLATFORM, { w: 100, x: 200, y: 40 }),\n    Object.assign({}, BASE_PLATFORM, { w: 500, x: 400, y: 40 }),\n    Object.assign({}, BASE_PLATFORM, { w: 50, x: 1000, y: 40 }),\n    Object.assign({}, BASE_PLATFORM, { w: 50, x: 1150, y: 40 }),\n    Object.assign({}, BASE_PLATFORM, { w: 50, x: 1300, y: 40 }),\n    Object.assign({}, BASE_PLATFORM, { w: 50, x: 1450, y: 40 }),\n    Object.assign({}, BASE_PLATFORM, { w: 500, x: 1650, y: 40 }),\n    Object.assign({}, BASE_PLATFORM, { w: 200, x: 2150, y: 160 }),\n    Object.assign({}, BASE_PLATFORM, { w: 300, x: 2530, y: 70 }),\n    Object.assign({}, BASE_PLATFORM, { w: 150, x: 2610, y: 120 }),\n    Object.assign({}, BASE_OBSTACLE, { w: 20, y: 190, h: 1000, x: 2860 }),\n    Object.assign({}, BASE_PLATFORM, { w: 200, x: 2950, y: 160 }),\n  ],\n};\n","import { render } from \"./Game.vue?vue&type=template&id=96c50728&scoped=true\"\nimport script from \"./Game.vue?vue&type=script&lang=js\"\nexport * from \"./Game.vue?vue&type=script&lang=js\"\n\nimport \"./Game.vue?vue&type=style&index=0&id=96c50728&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-96c50728\"\n\nexport default script","import { render } from \"./App.vue?vue&type=template&id=dd005110\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\n\nimport \"./App.vue?vue&type=style&index=0&id=dd005110&lang=css\"\nscript.render = render\n\nexport default script","import { createApp } from \"vue\";\nimport App from \"./App.vue\";\n\ncreateApp(App).mount(\"#app\");\n"],"sourceRoot":""}